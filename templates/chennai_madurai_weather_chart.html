<!DOCTYPE html>
<html lang="en" data-theme="cyberpunk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chennai and Madurai Weather Chart</title>

    <!-- TailwindCSS -->

    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@4.9.0/dist/full.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Add Chart.js library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.js"></script>
  </head>
  <body>
    <div>
      <canvas id="weatherChart"></canvas>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Fetch data from SQL table
        Promise.all([
          fetch("/api/weather-data/chennai").then((response) =>
            response.json()
          ),
          fetch("/api/weather-data/madurai").then((response) =>
            response.json()
          ),
        ])
          .then(([chennaiData, maduraiData]) => {
            const chartData = {
              labels: chennaiData.labels,
              datasets: [
                {
                  label: "Chennai Temperature (°C)",
                  data: chennaiData.temperatures,
                  backgroundColor: "rgba(255, 99, 132, 0.2)",
                  borderColor: "rgba(255, 99, 132, 1)",
                  borderWidth: 1,
                  yAxisID: "y",
                },
                {
                  label: "Madurai Temperature (°C)",
                  data: maduraiData.temperatures,
                  backgroundColor: "rgba(54, 162, 235, 0.2)",
                  borderColor: "rgba(54, 162, 235, 1)",
                  borderWidth: 1,
                  yAxisID: "y1",
                },
              ],
            };

            const ctx = document
              .getElementById("weatherChart")
              .getContext("2d");

            new Chart(ctx, {
              type: "line",
              data: chartData,
              options: {
                responsive: true,
                interaction: {
                  mode: "index",
                  intersect: false,
                },
                stacked: false,
                plugins: {
                  title: {
                    display: true,
                    text: "Chennai and Madurai Weather Chart",
                  },
                },
                scales: {
                  y: {
                    type: "linear",
                    display: true,
                    position: "left",
                  },
                  y1: {
                    type: "linear",
                    display: true,
                    position: "right",
                    grid: {
                      drawOnChartArea: false,
                    },
                  },
                },
              },
            });
          })
          .catch((error) => {
            console.error("Error fetching weather data:", error);
          });
      });
    </script>
  </body>
</html>
